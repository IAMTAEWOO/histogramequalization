# histogramequalization
Streaming HE Core


# HistEq Core - μ‹¤μ‹κ°„ νμ¤ν† κ·Έλ¨ μ΄ν€„λΌμ΄μ μ΄μ… IP

**320x240 ν”„λ μ„**μ—μ„ **1ν”„λ μ„ ν•™μµ β†’ 4ν”„λ μ„ μ μ©** λ°©μ‹μΌλ΅ **μ¤νΈλ¦¬λ° νμ¤ν† κ·Έλ¨ μ΄ν€„λΌμ΄μ μ΄μ…**μ„ μν–‰ν•λ” **RTL IP μ½”μ–΄**μ…λ‹λ‹¤.

## π― ν•µμ‹¬ νΉμ§•

```
π―  μ‹¤μ‹κ°„ μ¤νΈλ¦¬λ° μ²λ¦¬ (λ°±ν”„λ μ…” μ§€μ›)
π―  1ν”„λ μ„ ν•™μµ β†’ 4ν”„λ μ„ μ μ© (5ν”„λ μ„ μ£ΌκΈ°)
π―  256bin νμ¤ν† κ·Έλ¨ + CDF β†’ LUT μλ™ μƒμ„±
π―  νλΌλ―Έν„°ν™” (WIDTH=320, HEIGHT=240)
π―  FSM κΈ°λ° 4μƒνƒ μ μ–΄ (IDLE/LEARN/LUTC/STREAM)
```

## π—οΈ μ•„ν‚¤ν…μ² κ°μ”

```
μ…λ ¥ 8bit Gray β†’ [FSM] β†’ νμ¤ν† κ·Έλ¨ λ„μ  β†’ CDF κ³„μ‚° β†’ LUT μƒμ„± β†’ μ¶λ ¥ 8bit Eq
                  β†“
             256 x 16bit hist[] / cdf[] / 8bit lut[]
```

**μƒνƒ μ „μ΄**:
```
IDLE β†’ LEARN(1ν”„λ μ„) β†’ LUTC(CDFβ†’LUT) β†’ STREAM(4ν”„λ μ„) β†’ λ°λ³µ
```

## π“ μΈν„°νμ΄μ¤

| μ‹ νΈ | λ°©ν–¥ | ν­ | μ„¤λ… |
|------|------|----|------|
| `i_clk` | in | 1 | ν΄λ­ |
| `i_rst_n` | in | 1 | λΉ„λ™κΈ° λ¦¬μ…‹ |
| `i_valid` | in | 1 | μ…λ ¥ λ°μ΄ν„° μ ν¨ |
| `i_gray` | in | 8 | μ…λ ¥ κ·Έλ μ΄μ¤μΌ€μΌ |
| `i_end` | in | 1 | ν”„λ μ„ λ |
| `o_in_ready` | out | 1 | μ…λ ¥ μ¤€λΉ„λ¨ |
| `i_out_ready` | in | 1 | μ¶λ ¥ μ†λΉ„ κ°€λ¥ |
| `o_valid` | out | 1 | μ¶λ ¥ λ°μ΄ν„° μ ν¨ |
| `o_gray_eq` | out | 8 | μ΄ν€„λΌμ΄μ¦λ“ μ¶λ ¥ |
| `o_done` | out | 1 | LUT μƒμ„± μ™„λ£ ν„μ¤ |



## π§ κ²€μ¦ λ°©λ²•

```systemverilog
// Testbench μμ‹
module tb_hist_eq_core;
    // ... DUT μΈμ¤ν„΄μ¤
    
    initial begin
        // 1. μ²« ν”„λ μ„: ν•™μµ (μ¶λ ¥ X)
        send_frame(gray_frame1);  // hist λ„μ 
        
        // 2. LUTC μλ™ μν–‰ β†’ LUT μƒμ„±
        wait(o_done);
        
        // 3. 4ν”„λ μ„: LUT μ μ© μ¶λ ¥ ν™•μΈ
        for(int i=0; i<4; i++) begin
            send_frame(test_frame);
            check_eq_output(expected_eq[i]);
        end
    end
endmodule
```

## π“ λ¦¬μ†μ¤ μ‚¬μ©λ‰ (μμƒ)

```
LUT:  ~1.2K (256x8 + FSM + μ μ–΄)
FF:   ~2.5K (256x16x2 + μΉ΄μ΄ν„°)
BRAM: μ—†μ (λ¶„μ‚° RAM)
μ£Όνμ: 200MHz+ (νμ΄ν”„λΌμΈ μ—†μ)
```

## π”§ μ„¤μ • νλΌλ―Έν„°

```verilog
parameter WIDTH  = 320,  // ν”„λ μ„ κ°€λ΅
parameter HEIGHT = 240;  // ν”„λ μ„ μ„Έλ΅
```

## π“ ν•™μ μ  μμ

- **λ©”λ¨λ¦¬ ν¨μ¨**: 1KB λ―Έλ§μΌλ΅ ν’€HD μ΄ν€„λΌμ΄μ μ΄μ…
- **μ¤νΈλ¦¬λ° μµμ ν™”**: λ°±ν”„λ μ…” μ§€μ›μΌλ΅ μƒμ„ RGB2Grayμ™€ λ™κΈ°ν™”
- **μ μ‘ν• ν•™μµ**: 5ν”„λ μ„ μ£ΌκΈ° μλ™ κ°±μ‹ 
- **SoC ν†µν•©μ„±**: AXI μ¤νΈλ¦Ό νΈν™ κ°€λ¥

## π€ λ‹¤μ λ‹¨κ³„

- [ ] νμ΄ν”„λΌμΈ μ¶”κ°€ (2stage)
- [ ] AXI Stream μΈν„°νμ΄μ¤
- [ ] Vivado IP ν†µν•©
