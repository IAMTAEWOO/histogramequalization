# histogramequalization
Streaming HE Core


# HistEq Core - ì‹¤ì‹œê°„ íˆìŠ¤í† ê·¸ë¨ ì´í€„ë¼ì´ì œì´ì…˜ IP

**320x240 í”„ë ˆì„**ì—ì„œ **1í”„ë ˆì„ í•™ìŠµ â†’ 4í”„ë ˆì„ ì ìš©** ë°©ì‹ìœ¼ë¡œ **ìŠ¤íŠ¸ë¦¬ë° íˆìŠ¤í† ê·¸ë¨ ì´í€„ë¼ì´ì œì´ì…˜**ì„ ìˆ˜í–‰í•˜ëŠ” **RTL IP ì½”ì–´**ì…ë‹ˆë‹¤.

## ğŸ¯ í•µì‹¬ íŠ¹ì§•

```
ğŸ¯  ì‹¤ì‹œê°„ ìŠ¤íŠ¸ë¦¬ë° ì²˜ë¦¬ (ë°±í”„ë ˆì…” ì§€ì›)
ğŸ¯  1í”„ë ˆì„ í•™ìŠµ â†’ 4í”„ë ˆì„ ì ìš© (5í”„ë ˆì„ ì£¼ê¸°)
ğŸ¯  256bin íˆìŠ¤í† ê·¸ë¨ + CDF â†’ LUT ìë™ ìƒì„±
ğŸ¯  íŒŒë¼ë¯¸í„°í™” (WIDTH=320, HEIGHT=240)
ğŸ¯  FSM ê¸°ë°˜ 4ìƒíƒœ ì œì–´ (IDLE/LEARN/LUTC/STREAM)
```

## ğŸ—ï¸ ì•„í‚¤í…ì²˜ ê°œìš”

```
ì…ë ¥ 8bit Gray â†’ [FSM] â†’ íˆìŠ¤í† ê·¸ë¨ ëˆ„ì  â†’ CDF ê³„ì‚° â†’ LUT ìƒì„± â†’ ì¶œë ¥ 8bit Eq
                  â†“
             256 x 16bit hist[] / cdf[] / 8bit lut[]
```

**ìƒíƒœ ì „ì´**:
```
IDLE â†’ LEARN(1í”„ë ˆì„) â†’ LUTC(CDFâ†’LUT) â†’ STREAM(4í”„ë ˆì„) â†’ ë°˜ë³µ
```

## ğŸ“ ì¸í„°í˜ì´ìŠ¤

| ì‹ í˜¸ | ë°©í–¥ | í­ | ì„¤ëª… |
|------|------|----|------|
| `i_clk` | in | 1 | í´ëŸ­ |
| `i_rst_n` | in | 1 | ë¹„ë™ê¸° ë¦¬ì…‹ |
| `i_valid` | in | 1 | ì…ë ¥ ë°ì´í„° ìœ íš¨ |
| `i_gray` | in | 8 | ì…ë ¥ ê·¸ë ˆì´ìŠ¤ì¼€ì¼ |
| `i_end` | in | 1 | í”„ë ˆì„ ë |
| `o_in_ready` | out | 1 | ì…ë ¥ ì¤€ë¹„ë¨ |
| `i_out_ready` | in | 1 | ì¶œë ¥ ì†Œë¹„ ê°€ëŠ¥ |
| `o_valid` | out | 1 | ì¶œë ¥ ë°ì´í„° ìœ íš¨ |
| `o_gray_eq` | out | 8 | ì´í€„ë¼ì´ì¦ˆë“œ ì¶œë ¥ |
| `o_done` | out | 1 | LUT ìƒì„± ì™„ë£Œ í„ìŠ¤ |

## âš™ï¸ ë™ì‘ ìˆœì„œ (ìˆ˜ì •)

```mermaid
stateDiagram-v2
    [*] --> IDLE
    IDLE --> LEARN : !lut_valid
    IDLE --> STREAM : lut_valid
    LEARN --> LUTC : i_end
    LUTC --> IDLE : LUTì™„ë£Œ
    STREAM --> IDLE : use_cnt==3

## ğŸ§ª ê²€ì¦ ë°©ë²•

```systemverilog
// Testbench ì˜ˆì‹œ
module tb_hist_eq_core;
    // ... DUT ì¸ìŠ¤í„´ìŠ¤
    
    initial begin
        // 1. ì²« í”„ë ˆì„: í•™ìŠµ (ì¶œë ¥ X)
        send_frame(gray_frame1);  // hist ëˆ„ì 
        
        // 2. LUTC ìë™ ìˆ˜í–‰ â†’ LUT ìƒì„±
        wait(o_done);
        
        // 3. 4í”„ë ˆì„: LUT ì ìš© ì¶œë ¥ í™•ì¸
        for(int i=0; i<4; i++) begin
            send_frame(test_frame);
            check_eq_output(expected_eq[i]);
        end
    end
endmodule
```

## ğŸ“Š ë¦¬ì†ŒìŠ¤ ì‚¬ìš©ëŸ‰ (ì˜ˆìƒ)

```
LUT:  ~1.2K (256x8 + FSM + ì œì–´)
FF:   ~2.5K (256x16x2 + ì¹´ìš´í„°)
BRAM: ì—†ìŒ (ë¶„ì‚° RAM)
ì£¼íŒŒìˆ˜: 200MHz+ (íŒŒì´í”„ë¼ì¸ ì—†ìŒ)
```

## ğŸ”§ ì„¤ì • íŒŒë¼ë¯¸í„°

```verilog
parameter WIDTH  = 320,  // í”„ë ˆì„ ê°€ë¡œ
parameter HEIGHT = 240;  // í”„ë ˆì„ ì„¸ë¡œ
```

## ğŸ“ í•™ìˆ ì  ì˜ì˜

- **ë©”ëª¨ë¦¬ íš¨ìœ¨**: 1KB ë¯¸ë§Œìœ¼ë¡œ í’€HD ì´í€„ë¼ì´ì œì´ì…˜
- **ìŠ¤íŠ¸ë¦¬ë° ìµœì í™”**: ë°±í”„ë ˆì…” ì§€ì›ìœ¼ë¡œ ìƒìœ„ RGB2Grayì™€ ë™ê¸°í™”
- **ì ì‘í˜• í•™ìŠµ**: 5í”„ë ˆì„ ì£¼ê¸° ìë™ ê°±ì‹ 
- **SoC í†µí•©ì„±**: AXI ìŠ¤íŠ¸ë¦¼ í˜¸í™˜ ê°€ëŠ¥

## ğŸš€ ë‹¤ìŒ ë‹¨ê³„

- [ ] íŒŒì´í”„ë¼ì¸ ì¶”ê°€ (2stage)
- [ ] AXI Stream ì¸í„°í˜ì´ìŠ¤
- [ ] Vivado IP í†µí•©
